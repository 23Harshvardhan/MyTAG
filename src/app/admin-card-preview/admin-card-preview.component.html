<!-- Import for FontAwesome icons. -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">

<!-- Overlay for navigation menu in mobile view. -->
<div class="overlay" id="overlay">
    <div class="logoContainer">
        <img src="../../assets/img/logo.jpg" alt="MyTag Logo" class="navLogo">
    </div>
  <nav class="overlay-menu">
    <ul>
        <li class="gapTop"><div class="flexBox"><a routerLink="/dashboard"><i class="fa-solid fa-table-columns" style="color: white;"></i>Dashboard</a></div></li>
        <li><div class="flexBox"><a routerLink="/inventory"><i class="fa-solid fa-boxes-stacked" style="color: white;"></i>Inventory</a></div></li>
        <li><div class="flexBox"><a routerLink="/accounts"><i class="fa-solid fa-users" style="color: white;"></i>Accounts</a></div></li>
        <li><div class="flexBox"><a routerLink="/activeCards"><i class="fa-solid fa-address-card" style="color: white;"></i>Active Cards</a></div></li>
        <li><div class="flexBox"><a routerLink="/orders"><i class="fa-solid fa-store" style="color: white;"></i>Orders</a></div></li>
        <li><div class="flexBox"><a><i class="fa-solid fa-table-columns" style="color: white;"></i>Products</a></div></li>
        <li><div class="flexBox"><a><i class="fa-solid fa-table-columns" style="color: white;"></i>Templates</a></div></li>
        <li><div class="flexBox"><a routerLink="/adminSettings"><i class="fa-solid fa-gear" style="color: white;"></i>Settings</a></div></li>
        <li><div class="flexBox"><a routerLink="/"><i class="fa-solid fa-arrow-right-from-bracket" style="color: white;"></i>Log Out</a></div></li>
    </ul>
  </nav>
</div>

<!-- Overlay for image cropper. -->
<div class="imageCropperOverlay hidden" id="cropperOverlay">
    <div class="cropperBox">
        <div class="cropArea">
        <image-cropper
            [imageChangedEvent]="imgChangeEvent1"
            [aspectRatio]="4/4"
            [maintainAspectRatio]="true"
            [resizeToWidth]="256"
            format="png"
            (imageCropped)="cropImg($event)"
            (imageLoaded)="imgLoad()"
            (cropperReady)="initCropper()"
            (loadImageFailed)="imgFailed()"
        ></image-cropper>
        </div>

        <div class="cropperButtonRow">
            <button class="cropperBtn secondary" (click)="cancelCropper()">Cancel</button>
            <button class="cropperBtn primary" (click)="finalizeCrop()">Finish</button> 
        </div>
    </div>
</div>

<!-- Code for entire page. -->
<div class="body">
    <!-- Div to give spacing for vertical navbar in desktop view. -->
    <div class="area" style="width: 60px;"></div>
    <app-admin-vert-navbar></app-admin-vert-navbar>
    
    <div class="contentArea">
        <div class="horizontalNavArea">
            <div class="hamContainer">
                <div class="button_container" id="toggle" (click)="toggleNav()"><span class="top"></span><span class="middle"></span><span class="bottom"></span></div>
                <h1 class="pageTitle">Cards</h1> 
            </div>
        </div>

        <div class="cardsPanel">
            <div class="cards">
                <div class="card">
                    <div class="upperCard" id="upperCard">
                        <div class="container cardNavArea">
                            <!-- <input type="button" value="Add Image" class="btn1"> -->
                            <img class="logo" id="logo" [src]="logoUrl">
                            <p class="editBtn" (click)="toggleEditField('cardHeadArea')">Edit</p>
                        </div>
                    </div>
                    
                    <div class="container cardHeadArea" id="cardHead">
                        <img class="profilePic" id="profilePic" [src]="imageUrl">
        
                        <div class="nameDetailsPnl">
                            <h3 class="nameField">{{data.Name}}</h3>
                            <p class="designationField">{{data.Job_title}}</p>
                            <p class="companyField">{{data.Company_name}}</p>
                        </div>
                    </div>
                    
                    <div class="container shareArea" id="shareArea">
                        <input type="button" value="Save Contact" class="secondaryBtn">
                        <input type="button" value="Exchange Contact" class="primaryBtn">
                    </div>

                    <div class="container descArea">
                        <p class="descField" id="descArea">{{data.Headline}}</p>
                    </div>

                    <div id="cardHeadArea" class="hidden">
                        <div class="container cardHeadEditArea" id="cardHeadArea">
                            <div class="saveBtnArea">
                                <input type="button" value="Save" class="btn2" (click)="updateCard(cardID, userId)">
                            </div>
                            <h3 class="editHeading">Edit your Card Header</h3>
                            <div class="editBodyArea">
                                <h4>Profile Picture</h4>
                                <input type="file" #imgInput id="FileUpload1" (change)="onFileSelected($event)">
                                <h4>Logo</h4>
                                <input type="file" #imgInput2 id="FileUpload2" (change)="onFileSelected2($event)">
                                <h4>Name</h4>
                                <input class="inputField" id="Name" placeholder="Your Name" value={{data.Name}} (keyup)="selectField('Name')" maxlength="41">
                                <h4>Designation</h4>
                                <input class="inputField" id="Job_title" placeholder="Your Designation" value={{data.Job_title}} (keyup)="selectField('Job_title')">
                                <h4>Company Name</h4>
                                <input class="inputField" id="Company_name" placeholder="Your Company Name" value={{data.Company_name}} (keyup)="selectField('Company_name')">
                                <h4>Headline</h4>
                                <textarea class="inputField" maxlength="96" id="Headline" placeholder="Enter Headline" rows="2" wrap="soft" (keyup)="selectField('Headline')">{{data.Headline}}</textarea>
                            </div>
                        </div>
                    </div>
                    <div class="width95" id="socialDetailSection">
                        <div class="editBtnArea" id="editBtnArea">
                            <p class="sectionHeading">Social Networks</p>
                            <p class="editBtn" (click)="toggleEditField('socialEditSection')">Edit</p>
                        </div>

                        <div class="socialIcons">
                            <i class="fa-brands fa-twitter" *ngIf="data.Twitter.length > 0"></i>
                            <i class="fa-brands fa-instagram" *ngIf="data.Instagram.length > 0"></i>
                            <i class="fa-brands fa-linkedin" *ngIf="data.Linkedin.length > 0"></i>
                            <i class="fa-brands fa-facebook" *ngIf="data.Facebook.length > 0"></i>
                            <i class="fa-brands fa-youtube" *ngIf="data.Youtube.length > 0"></i>
                            <i class="fa-brands fa-snapchat" *ngIf="data.Snapchat.length > 0"></i>
                            <i class="fa-brands fa-tiktok" *ngIf="data.Tiktok.length > 0"></i>
                            <i class="fa-brands fa-twitch" *ngIf="data.Twitch.length > 0"></i>
                            <i class="fa-brands fa-yelp" *ngIf="data.Yelp.length > 0"></i>
                            <i class="fa-brands fa-discord" *ngIf="data.Discord.length > 0"></i>
                            <i class="fa-brands fa-whatsapp" *ngIf="data.Whatsapp.length > 0"></i>
                            <i class="fa-brands fa-skype" *ngIf="data.Skype.length > 0"></i>
                            <i class="fa-brands fa-telegram" *ngIf="data.Telegram.length > 0"></i>
                        </div>
                    </div>

                    <div class="width95 hidden" id="socialEditSection">
                        <div class="container cardHeadEditArea">
                            <div class="saveBtnArea">
                                <input type="button" value="Save" class="btn2" (click)="updateCard(cardID, userId)">
                            </div>
                            <h3 class="editHeading">Edit your Social Details</h3>
                            <div class="editBodyArea">
                                <div class="selectContainer">
                                    <select id="social1" class="socialSelector">
                                        <option value="Twitter">Twitter</option>
                                        <option value="Instagram">Instagram</option>
                                        <option value="Linkedin">LinkedIn</option>
                                        <option value="Facebook">Facebook</option>
                                        <option value="Youtube">YouTube</option>
                                        <option value="Snapchat">Snapchat</option>
                                        <option value="Tiktok">TikTok</option>
                                        <option value="Twitch">Twitch</option>
                                        <option value="Yelp">Yelp</option>
                                        <option value="Discord">Discord</option>
                                        <option value="Whatsapp">WhatsApp</option>
                                        <option value="Skype">Skype</option>
                                        <option value="Telegram">Telegram</option>
                                    </select>

                                    <input class="inputField" id="socialLink1" placeholder="Link" value="">
                                </div>

                                <div class="selectContainer">
                                    <select id="social2" class="socialSelector">
                                        <option value="Instagram">Instagram</option>
                                        <option value="Twitter">Twitter</option>
                                        <option value="Linkedin">LinkedIn</option>
                                        <option value="Facebook">Facebook</option>
                                        <option value="Youtube">YouTube</option>
                                        <option value="Snapchat">Snapchat</option>
                                        <option value="Tiktok">TikTok</option>
                                        <option value="Twitch">Twitch</option>
                                        <option value="Yelp">Yelp</option>
                                        <option value="Discord">Discord</option>
                                        <option value="Whatsapp">WhatsApp</option>
                                        <option value="Skype">Skype</option>
                                        <option value="Telegram">Telegram</option>
                                    </select>

                                    <input class="inputField" id="socialLink2" placeholder="Link" value="">
                                </div>

                                <div class="selectContainer">
                                    <select id="social3" class="socialSelector">
                                        <option value="Linkedin">LinkedIn</option>
                                        <option value="Twitter">Twitter</option>
                                        <option value="Instagram">Instagram</option>
                                        <option value="Facebook">Facebook</option>
                                        <option value="Youtube">YouTube</option>
                                        <option value="Snapchat">Snapchat</option>
                                        <option value="Tiktok">TikTok</option>
                                        <option value="Twitch">Twitch</option>
                                        <option value="Yelp">Yelp</option>
                                        <option value="Discord">Discord</option>
                                        <option value="Whatsapp">WhatsApp</option>
                                        <option value="Skype">Skype</option>
                                        <option value="Telegram">Telegram</option>
                                    </select>

                                    <input class="inputField" id="socialLink3" placeholder="Link" value="">
                                </div>

                                <div class="selectContainer">
                                    <select id="social4" class="socialSelector">
                                        <option value="Facebook">Facebook</option>
                                        <option value="Twitter">Twitter</option>
                                        <option value="Instagram">Instagram</option>
                                        <option value="Linkedin">LinkedIn</option>
                                        <option value="Youtube">YouTube</option>
                                        <option value="Snapchat">Snapchat</option>
                                        <option value="Tiktok">TikTok</option>
                                        <option value="Twitch">Twitch</option>
                                        <option value="Yelp">Yelp</option>
                                        <option value="Discord">Discord</option>
                                        <option value="Whatsapp">WhatsApp</option>
                                        <option value="Skype">Skype</option>
                                        <option value="Telegram">Telegram</option>
                                    </select>

                                    <input class="inputField" id="socialLink4" placeholder="Link" value="">
                                </div>

                                <div class="selectContainer">
                                    <select id="social5" class="socialSelector">
                                        <option value="Youtube">YouTube</option>
                                        <option value="Twitter">Twitter</option>
                                        <option value="Instagram">Instagram</option>
                                        <option value="Linkedin">LinkedIn</option>
                                        <option value="Facebook">Facebook</option>
                                        <option value="Snapchat">Snapchat</option>
                                        <option value="Tiktok">TikTok</option>
                                        <option value="Twitch">Twitch</option>
                                        <option value="Yelp">Yelp</option>
                                        <option value="Discord">Discord</option>
                                        <option value="Whatsapp">WhatsApp</option>
                                        <option value="Skype">Skype</option>
                                        <option value="Telegram">Telegram</option>
                                    </select>

                                    <input class="inputField" id="socialLink5" placeholder="Link" value="">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="basicContactSection" class="width95">

                        <div class="editBtnArea" id="editBtnArea">
                            <p class="sectionHeading">Contact Info</p>
                            <p class="editBtn" (click)="toggleEditField('basicDetailArea')">Edit</p>
                        </div>

                        <div class="container basicContactArea" id="basicContactArea">
                            <div class="cardInfoCont">
                                <i class="fa-solid fa-phone"></i>
                                <p class="intel">{{data.Phone}}</p>
                            </div>
                        </div> 
            
                        <div class="container basicContactArea" id="basicContactArea">
                            <div class="cardInfoCont">
                                <i class="fa-solid fa-envelope"></i>
                                <p class="intel">{{data.Email}}</p>
                            </div>
                        </div> 
            
                        <div class="container basicContactArea" id="basicContactArea">
                            <div class="cardInfoCont">
                                <i class="fa-solid fa-globe"></i>
                                <p class="intel">{{data.Link}}</p>
                            </div>
                        </div> 
            
                        <div class="container basicContactArea" id="basicContactArea">
                            <div class="cardInfoCont">
                                <i class="fa-solid fa-map"></i>
                                <p class="intel">{{data.Address}}</p>
                            </div>
                        </div> 
                    </div>

                    <div id="basicDetailEditArea" class="width95 hidden">
                        <div class="container cardHeadEditArea" id="basicDetailArea">
                            <div class="saveBtnArea">
                                <input type="button" value="Save" class="btn2" (click)="updateCard(cardID, userId)">
                            </div>
                            <h3 class="editHeading">Edit your Basic Details</h3>
                            <div class="editBodyArea">
                                <h4>Contact No</h4>
                                <input class="inputField" id="Phone" placeholder="Your contact number" value={{data.Phone}} (keyup)="selectField('Phone')">
                                <h4>Email</h4>
                                <input class="inputField" id="Email" placeholder="Your Email" value={{data.Email}} (keyup)="selectField('Email')">
                                <h4>Website</h4>
                                <input class="inputField" id="Link" placeholder="Your website" value={{data.Link}} (keyup)="selectField('Link')">
                                <h4>Address</h4>
                                <textarea class="inputField" maxlength="96" id="Address" placeholder="Your Address" rows="3" wrap="soft" (keyup)="selectField('Address')">{{data.Address}}</textarea>
                            </div>
                        </div>
                    </div>

                    <div class="" id="videoArea">
                        <div class="editBtnArea" id="editBtnArea">
                            <p class="sectionHeading">Video</p>
                            <p class="editBtn" (click)="toggleEditField('videoEditArea')">Edit</p>
                        </div>

                        <div class="container flexColumn" *ngIf="data.Company_URL.length > 0">
                            <iframe width="330px" height="200" controls style="border-radius: 15px;" [src]="getSafeUrl(finalLink)" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </div>
                    </div>

                    <div id="videoEditArea" class="width95 hidden">
                        <div class="container cardHeadEditArea">
                            <div class="saveBtnArea">
                                <input type="button" value="Save" class="btn2" (click)="updateCard(cardID, userId)">
                            </div>
                            <h3 class="editHeading">Edit your YouTube video link</h3>
                            <div class="editBodyArea">
                                <input class="inputField" id="Company_URL" placeholder="Link to YouTube video" value={{data.Company_URL}} (keyup)="selectField('Company_URL')">
                            </div>
                        </div>
                    </div>

                    <div class="" id="linksArea">
                        <div class="editBtnArea" id="editBtnArea">
                            <p class="sectionHeading">Links</p>
                            <p class="editBtn" (click)="toggleEditField('linksEditArea')">Edit</p>
                        </div>
                        <div class="container basicContactArea" *ngIf="data.Calendly.length > 0">
                            <div class="cardInfoCont">
                                <i class="fa-solid fa-link"></i>
                                <p class="intel">{{data.Calendly}}</p>
                            </div>
                        </div> 
                        <div class="container basicContactArea" *ngIf="data.Github.length > 0">
                            <div class="cardInfoCont">
                                <i class="fa-solid fa-link"></i>
                                <p class="intel">{{data.Github}}</p>
                            </div>
                        </div> 
                        <div class="container basicContactArea" *ngIf="data.Paypal.length > 0">
                            <div class="cardInfoCont">
                                <i class="fa-solid fa-link"></i>
                                <p class="intel">{{data.Paypal}}</p>
                            </div>
                        </div> 
                    </div>

                    <div id="linksEditArea" class="width95 hidden">
                        <div class="container cardHeadEditArea">
                            <div class="saveBtnArea">
                                <input type="button" value="Save" class="btn2" (click)="updateCard(cardID, userId)">
                            </div>
                            <h3 class="editHeading">Edit your Links</h3>
                            <div class="editBodyArea">
                                <h4>Calendly</h4>
                                <input class="inputField" id="Calendly" placeholder="Link" value={{data.Calendly}} (keyup)="selectField('Calendly')">
                                <h4>GitHub</h4>
                                <input class="inputField" id="Github" placeholder="Link" value={{data.Github}} (keyup)="selectField('Github')">
                                <h4>PayPal</h4>
                                <input class="inputField" id="Paypal" placeholder="Link" value={{data.Paypal}} (keyup)="selectField('Paypal')">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flexColumn">
                    <div>
                        <div class="userName fontMontserrateSemiBold">Email Signature</div>

                        <div class="pnl sigPnl">
                            <div class="btnRow">
                                <button class="sigBtn">QR Code</button>
                                <button class="sigBtn">Logo & Image</button>
                                <button class="sigBtn">Logo</button>
                                <button class="sigBtn">Text</button>
                            </div>

                            <div id="html">
                                <div class="signatureBox">
                                    <div class="sigBoxHeader">
                                        <div class="imgCont">
                                            <img class="profilePic sigImg" id="profilePic" [src]="imageUrl">
                                        </div>
                                        <div class="basicInfoCont">
                                            <h5 class="nameData">{{data.Name}}</h5>
                                            <p class="data">{{data.Job_title}}</p>
                                            <p class="data">{{data.Company_name}}</p>
                                        </div>
                                        <div class="logoCont">
                                            <img class="profilePic sigLogo" id="profilePic" [src]="logoUrl">
                                        </div>
                                    </div>
                                    <div class="sigBoxBody">
                                        <div class="basicInfoCont">
                                            <div style="gap: 5px; flex-direction: row; display: flex;">
                                                <i class="fa-solid fa-phone data"></i>
                                                <p class="data">{{data.Phone}}</p>
                                            </div>
                                            <div style="gap: 5px; flex-direction: row; display: flex;">
                                                <i class="fa-solid fa-mobile data"></i>
                                                <p class="data">{{data.Phone}}</p>
                                            </div>
                                            <div style="gap: 5px; flex-direction: row; display: flex;">
                                                <i class="fa-solid fa-envelope data"></i>
                                                <p class="data">{{data.Email}}</p>
                                            </div>
                                            <div style="gap: 5px; flex-direction: row; display: flex;">
                                                <i class="fa-solid fa-link data"></i>
                                                <p class="data">{{data.Link}}</p>
                                            </div>
                                            <div style="gap: 5px; flex-direction: row; display: flex;">
                                                <i class="fa-solid fa-map data"></i>
                                                <p class="data">{{data.Address}}</p>
                                            </div>
                                        </div>
                                        <div class="qrCont">
                                            <qrcode [qrdata]="cardViewLink" [width]="80" [errorCorrectionLevel]="'M'"></qrcode>
                                        </div>
                                    </div>
                                    <div class="sigFooter">
                                        <div class="socialsCont">
                                            <i class="fa-brands fa-twitter" *ngIf="data.Twitter.length > 0"></i>
                                            <i class="fa-brands fa-instagram" *ngIf="data.Instagram.length > 0"></i>
                                            <i class="fa-brands fa-linkedin" *ngIf="data.Linkedin.length > 0"></i>
                                            <i class="fa-brands fa-facebook" *ngIf="data.Facebook.length > 0"></i>
                                            <i class="fa-brands fa-youtube" *ngIf="data.Youtube.length > 0"></i>
                                            <i class="fa-brands fa-snapchat" *ngIf="data.Snapchat.length > 0"></i>
                                            <i class="fa-brands fa-tiktok" *ngIf="data.Tiktok.length > 0"></i>
                                            <i class="fa-brands fa-twitch" *ngIf="data.Twitch.length > 0"></i>
                                            <i class="fa-brands fa-yelp" *ngIf="data.Yelp.length > 0"></i>
                                            <i class="fa-brands fa-discord" *ngIf="data.Discord.length > 0"></i>
                                            <i class="fa-brands fa-whatsapp" *ngIf="data.Whatsapp.length > 0"></i>
                                            <i class="fa-brands fa-skype" *ngIf="data.Skype.length > 0"></i>
                                            <i class="fa-brands fa-telegram" *ngIf="data.Telegram.length > 0"></i>
                                        </div>
                                        <div class="saveCont">
                                            <button class="cpySigBtn">Save Contact</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <button class="cpySigBtn marginTop10" (click)="cpySigBtn()">Copy Signature</button>
                            <p class="sigIntel">Copy above signature and paste it as your email signature</p>
                        </div>
                    </div>

                    <div class="flexRow">
                        <div class="pnl">
                                <qrcode [qrdata]="cardViewLink" [width]="250" [errorCorrectionLevel]="'M'"></qrcode>
                            <div class="userName fontMontserrateSemiBold">QR Code</div>
                        </div>
        
                        <div class="pnl">
                            <canvas baseChart width="400" height="400"
                            [data]="lineChartData"
                            [options]="lineChartOptions"
                            [type]="lineChartType"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>